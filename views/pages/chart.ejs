<!DOCTYPE html>
<html>
<head>
    <title>Chart</title>
    <meta charset="utf-8">
    <script src="//cdnjs.cloudflare.com/ajax/libs/dygraph/2.1.0/dygraph.min.js"></script>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/dygraph/2.1.0/dygraph.min.css" />
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
</head>
<body>
    <div id="chart"></div>
    <script>
        /*
        const chart = document.querySelector('#chart');

        function drawChart(data){
            new Dygraph(
            chart,
            data,
          {
            rollPeriod: 1,
            showRoller: true,
            customBars: true,
            //logscale: true,
            errorBars: true,
            title: 'Daily bitrate',
            ylabel: 'Bitrate',
            legend: 'always',
            valueRange: [0, 3000],
            showRangeSelector: true,
            rangeSelectorHeight: 30,
            rangeSelectorPlotStrokeColor: 'yellow',
            rangeSelectorPlotFillColor: 'lightyellow'
          }
        );
        }

        fetch('/getChart')
        .then(response => response.json())
        .then(data => {
            chartData = [];
            data.shift();
            data.shift();
            data.shift();
            for(let i = 0; i < data.length; i++){
                chartData.push([new Date(data[i].timestamp), data[i].bitrate]);
            }
            console.log(chartData);
            drawChart(chartData);
        });
        */
    </script>
      <script type='text/javascript'>
    
      google.charts.load('current', {'packages':['annotationchart']});
      google.charts.setOnLoadCallback(drawChart);

      function drawChart() {
        fetch('/getChart')
        .then(response => response.json())
        .then(data => {
            chartData = [];
            data.shift();
            data.shift();
            data.shift();
            for(let i = 0; i < data.length; i++){
                chartData.push([new Date(data[i].timestamp), data[i].bitrate, null, null, data[i].fps, null, null]);
            }
        var data = new google.visualization.DataTable();
        data.addColumn('date', 'Date');
        data.addColumn('number', 'Kepler-22b mission');
        data.addColumn('string', 'Kepler title');
        data.addColumn('string', 'Kepler text');
        data.addColumn('number', 'Gliese 163 mission');
        data.addColumn('string', 'Gliese title');
        data.addColumn('string', 'Gliese text');
        data.addRows([
          [new Date(2314, 2, 15), 12400, undefined, undefined,
                                  0, undefined, undefined],
          [new Date(2314, 2, 16), 24045, undefined, undefined,
                                  0, undefined, undefined],
          [new Date(2314, 2, 20), 0, undefined, undefined,
                                  0, undefined, undefined]
        ]);
        console.log(chartData);

        var chart = new google.visualization.AnnotationChart(document.getElementById('chart'));

        var options = {
          displayAnnotations: false
        };

        chart.draw(data, options);

      });
      }
    
    </script>
</body>
</html>